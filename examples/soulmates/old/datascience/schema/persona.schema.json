{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "persona.schema.json",
  "title": "Persona",
  "type": "object",
  "required": [
    "id",
    "domain",
    "general",
    "domainData",
    "conversations",
    "facts"
  ],
  "additionalProperties": false,
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^(D|C|F)-(SF|NY)-\\d{3}$"
    },
    "domain": {
      "type": "string",
      "enum": ["dating", "business", "friendship"]
    },
    "general": {
      "type": "object",
      "required": ["name", "age", "location"],
      "additionalProperties": true,
      "properties": {
        "name": {
          "type": "string",
          "minLength": 2
        },
        "age": {
          "type": "integer",
          "minimum": 18,
          "maximum": 99
        },
        "genderIdentity": {
          "type": "string"
        },
        "pronouns": {
          "type": "string"
        },
        "education": {
          "type": "string"
        },
        "values": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "location": {
          "type": "object",
          "required": ["city", "country"],
          "additionalProperties": true,
          "properties": {
            "city": {
              "type": "string",
              "minLength": 1
            },
            "country": {
              "type": "string",
              "minLength": 1
            }
          }
        }
      }
    },
    "domainData": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "dating": {
          "type": "object",
          "additionalProperties": true,
          "properties": {
            "sexualOrientation": {
              "type": "string"
            },
            "interests": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "hobbies": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "personalityTraits": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "communicationStyle": {
              "type": "string"
            },
            "schedule": {
              "type": "string"
            },
            "lifestyle": {
              "type": "object"
            },
            "relationshipGoal": {
              "type": "string"
            },
            "datingPreferences": {
              "type": "object"
            },
            "dealbreakers": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "appearance": {
              "type": "object",
              "description": "Physical appearance metadata for dating personas (used for profile image generation)",
              "additionalProperties": false,
              "properties": {
                "attractiveness": {
                  "type": "integer",
                  "minimum": 1,
                  "maximum": 10,
                  "description": "Perceived attractiveness on a 1-10 scale"
                },
                "build": {
                  "type": "string",
                  "enum": [
                    "thin",
                    "fit",
                    "average",
                    "above_average",
                    "overweight"
                  ],
                  "description": "Body build/weight category"
                },
                "hairColor": {
                  "type": "string",
                  "description": "Hair color (e.g., black, brown, blonde, red, gray, auburn)"
                },
                "eyeColor": {
                  "type": "string",
                  "description": "Eye color (e.g., brown, blue, green, hazel, gray)"
                },
                "skinTone": {
                  "type": "integer",
                  "minimum": 1,
                  "maximum": 10,
                  "description": "Skin tone on a 1-10 scale (1=very light, 10=very dark)"
                },
                "ethnicity": {
                  "type": "string",
                  "description": "Perceived ethnicity (e.g., white, black, asian, hispanic, mixed)"
                },
                "perceivedGender": {
                  "type": "integer",
                  "minimum": 1,
                  "maximum": 10,
                  "description": "Perceived gender presentation (1=very masculine, 5=androgynous, 10=very feminine)"
                },
                "distinctiveFeatures": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "Distinctive features like piercings, tattoos, glasses, facial hair, etc."
                }
              }
            }
          }
        },
        "business": {
          "type": "object",
          "additionalProperties": true,
          "properties": {
            "jobTitle": {
              "type": "string"
            },
            "industry": {
              "type": "string"
            },
            "education": {
              "type": "string"
            },
            "values": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "personalityTraits": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "equityExpectations": {
              "type": "string"
            }
          }
        },
        "friendship": {
          "type": "object",
          "additionalProperties": true,
          "properties": {
            "interests": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "hobbies": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "conversations": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["conversationId", "scenario", "turns"],
        "additionalProperties": false,
        "properties": {
          "conversationId": {
            "type": "string",
            "minLength": 1
          },
          "scenario": {
            "type": "string",
            "minLength": 1
          },
          "turns": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "object",
              "required": ["turnId", "role", "text"],
              "additionalProperties": false,
              "properties": {
                "turnId": {
                  "type": "string",
                  "minLength": 1
                },
                "role": {
                  "type": "string",
                  "enum": ["agent", "user"]
                },
                "text": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "facts": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "factId",
          "type",
          "key",
          "value",
          "confidence",
          "evidence"
        ],
        "additionalProperties": false,
        "properties": {
          "factId": {
            "type": "string",
            "minLength": 1
          },
          "type": {
            "type": "string",
            "minLength": 1
          },
          "key": {
            "type": "string",
            "minLength": 1
          },
          "value": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "number"
              },
              {
                "type": "boolean"
              },
              {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            ]
          },
          "confidence": {
            "type": "number",
            "minimum": 0,
            "maximum": 1
          },
          "evidence": {
            "type": "object",
            "required": ["conversationId", "turnIds"],
            "additionalProperties": false,
            "properties": {
              "conversationId": {
                "type": "string"
              },
              "turnIds": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    }
  }
}
